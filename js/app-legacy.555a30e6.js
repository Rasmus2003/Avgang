(function(t){function e(e){for(var i,a,s=e[0],c=e[1],u=e[2],l=0,p=[];l<s.length;l++)a=s[l],o[a]&&p.push(o[a][0]),o[a]=0;for(i in c)Object.prototype.hasOwnProperty.call(c,i)&&(t[i]=c[i]);f&&f(e);while(p.length)p.shift()();return r.push.apply(r,u||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],i=!0,a=1;a<n.length;a++){var s=n[a];0!==o[s]&&(i=!1)}i&&(r.splice(e--,1),t=c(c.s=n[0]))}return t}var i={},a={app:0},o={app:0},r=[];function s(t){return c.p+"js/"+({}[t]||t)+"-legacy."+{"chunk-4edf4bfa":"519acf88"}[t]+".js"}function c(e){if(i[e])return i[e].exports;var n=i[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-4edf4bfa":1};a[t]?e.push(a[t]):0!==a[t]&&n[t]&&e.push(a[t]=new Promise(function(e,n){for(var i="css/"+({}[t]||t)+"."+{"chunk-4edf4bfa":"7078ae55"}[t]+".css",a=c.p+i,o=document.getElementsByTagName("link"),r=0;r<o.length;r++){var s=o[r],u=s.getAttribute("data-href")||s.getAttribute("href");if("stylesheet"===s.rel&&(u===i||u===a))return e()}var l=document.getElementsByTagName("style");for(r=0;r<l.length;r++){s=l[r],u=s.getAttribute("data-href");if(u===i||u===a)return e()}var p=document.createElement("link");p.rel="stylesheet",p.type="text/css",p.onload=e,p.onerror=function(e){var i=e&&e.target&&e.target.src||a,o=new Error("Loading CSS chunk "+t+" failed.\n("+i+")");o.request=i,n(o)},p.href=a;var f=document.getElementsByTagName("head")[0];f.appendChild(p)}).then(function(){a[t]=0}));var i=o[t];if(0!==i)if(i)e.push(i[2]);else{var r=new Promise(function(e,n){i=o[t]=[e,n]});e.push(i[2]=r);var u,l=document.getElementsByTagName("head")[0],p=document.createElement("script");p.charset="utf-8",p.timeout=120,c.nc&&p.setAttribute("nonce",c.nc),p.src=s(t),u=function(e){p.onerror=p.onload=null,clearTimeout(f);var n=o[t];if(0!==n){if(n){var i=e&&("load"===e.type?"missing":e.type),a=e&&e.target&&e.target.src,r=new Error("Loading chunk "+t+" failed.\n("+i+": "+a+")");r.type=i,r.request=a,n[1](r)}o[t]=void 0}};var f=setTimeout(function(){u({type:"timeout",target:p})},12e4);p.onerror=p.onload=u,l.appendChild(p)}return Promise.all(e)},c.m=t,c.c=i,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)c.d(n,i,function(e){return t[e]}.bind(null,i));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/rasmus2.0/",c.oe=function(t){throw console.error(t),t};var u=window["webpackJsonp"]=window["webpackJsonp"]||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var p=0;p<u.length;p++)e(u[p]);var f=l;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"00ce":function(t,e,n){t.exports={locationInput:"LocationInput_locationInput_1Fmax",spinner:"LocationInput_spinner_2ic4d",resetLocationBtn:"LocationInput_resetLocationBtn_1OP_2",suggestions:"LocationInput_suggestions_3I4sW",withLabel:"LocationInput_withLabel_23-Ez",suggestion:"LocationInput_suggestion_3aHOF"}},"034f":function(t,e,n){"use strict";var i=n("c21b"),a=n.n(i);a.a},1436:function(t,e,n){"use strict";var i=n("3fa3"),a=n.n(i);a.a},1578:function(t,e,n){t.exports={updateAvailable:"UpdateAvailable_updateAvailable_uZAhH",updateAvailableActive:"UpdateAvailable_updateAvailableActive_1qO1M",reloadLink:"UpdateAvailable_reloadLink_10vaV",closeBtn:"UpdateAvailable_closeBtn_14n-V"}},"23f2":function(t,e,n){"use strict";var i=n("1578"),a=n.n(i);e["default"]=a.a},"2ede":function(t,e,n){t.exports={tripsTable:"TripsTable_tripsTable_seMaN",showingJourneyDetails:"TripsTable_showingJourneyDetails_2vlip",table:"TripsTable_table_2aCjV",tableHead:"TripsTable_tableHead_35rh1",trip:"TripsTable_trip_3L8k2",tripLine:"TripsTable_tripLine_1UetD",tripName:"TripsTable_tripName_1S77x",tripTime:"TripsTable_tripTime_MCuJO",tripNewTime:"TripsTable_tripNewTime_1TU8j",isLate:"TripsTable_isLate_332Tg",tripTrack:"TripsTable_tripTrack_hi4oT",tripNote:"TripsTable_tripNote_364hW",VT:"TripsTable_VT_zu_SE",TV:"TripsTable_TV_1mpPl",SL:"TripsTable_SL_1kF6p"}},"2f3b":function(t,e,n){"use strict";var i=n("b679"),a=n.n(i);e["default"]=a.a},"3fa3":function(t,e,n){},"55a3":function(t,e,n){"use strict";var i=n("2ede"),a=n.n(i);e["default"]=a.a},"56d7":function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("097d"),n("2dd2");var i,a,o=n("2b0e"),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("UpdateAvailable"),n("OfflineIndicator"),n("div",{staticClass:"build-info"},[t._v("build: "+t._s(t.buildTime))]),n("div",{staticClass:"top-nav"},[n("Tabs",{attrs:{tabs:t.tabs,"on-click":t.changeTab,"current-tab":t.currentTab}}),n("DigitalClock")],1),n("div",{staticClass:"container"},[n(t.currentTabComponent.componentName,t._b({tag:"component"},"component",t.currentTabComponent.props,!1))],1)],1)},s=[],c=(n("7514"),n("8afe")),u=(n("7f7f"),n("c93e")),l=n("2f62"),p=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{class:t.$style.informationPage},[t.isLoading?n("font-awesome",{class:t.$style.spinner,attrs:{icon:"spinner",spin:""}}):t._e(),n("div",{attrs:{id:t.gdocElementId}}),n("a",{class:t.$style.editLink,attrs:{href:t.editLink}},[t._v("Redigera")])],1)},f=[],d=(n("96cf"),n("4917"),n("a481"),n("28a5"),n("3040")),m="499673240843-8f8bn77590948esm040d5cl5s4k32hkq.apps.googleusercontent.com",v="AIzaSyAQVyCYvuXOxLcIMlT68G-ELLSxMVDqDGc",h=["https://www.googleapis.com/discovery/v1/apis/drive/v3/rest"],g=["https://www.googleapis.com/auth/drive","https://www.googleapis.com/auth/drive.file","https://www.googleapis.com/auth/drive.readonly","https://www.googleapis.com/auth/drive.metadata.readonly"].join(" "),b={Datum:"date","Hållplats":"origin",Linje:"sname",Namn:"direction",Tid:"time","Ny tid":"rtTime","Läge":"track",Bakgrund:"fgColor"},y={infoDoc:{fileId:"1TRE1P4EmB3kwlURit8lICniBtRp7aqnhcU8x7D6yzqI",mimeType:"text/html"},manualDepartures:{fileId:"1XSzg87FgHsxUl6UqNfRJtYIkw8wyN0yB3RzIib3JsvM",mimeType:"text/tab-separated-values"}},_=!1;function T(){return L.apply(this,arguments)}function L(){return L=Object(d["a"])(regeneratorRuntime.mark(function t(){var e;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!_){t.next=2;break}return t.abrupt("return");case 2:e=document.createElement("script"),e.addEventListener("load",function(){_=!0,gapi.load("client:auth2",w)}),e.src="https://apis.google.com/js/api.js",document.body.appendChild(e);case 6:case"end":return t.stop()}},t,this)})),L.apply(this,arguments)}var S=new Promise(function(t,e){i=t,a=e}).then(function(){if(gapi.auth2.getAuthInstance().isSignedIn.listen(j),!gapi.auth2.getAuthInstance().isSignedIn.get())return gapi.auth2.getAuthInstance().signIn()});function w(){gapi.client.init({apiKey:v,clientId:m,discoveryDocs:h,scope:g}).then(i).catch(a)}function D(t){return T(),S.then(function(){return A(y.infoDoc).then(function(e){return I(e,t)}).catch(function(t){return console.error(t)})})}function k(){return T(),S.then(function(){return A(y.manualDepartures).then(function(t){var e=t.body;return e}).then(function(t){var e=t.split(/\n/),n=e[0].replace(/\n|\r/g,"").split(/\t/);return e.slice(1).map(function(t){var e=t.split(/\t/);return n.reduce(function(t,n,i){var a=b[n]||n;return t[a]=e[i],t},{})})})})}function j(t){t||gapi.auth2.getAuthInstance().signIn()}function A(t){return gapi.client.drive.files.export(t)}function I(t,e){var n=t.body.match(/<body[^>]*>(.*)<\/body><\/html>$/)[1],i=document.getElementById(e);i.innerHTML=n}var O={init:T,printInfoDoc:D,getManualDepartures:k},$="https://docs.google.com/document/d/1TRE1P4EmB3kwlURit8lICniBtRp7aqnhcU8x7D6yzqI/edit#",C={name:"InformationPage",data:function(){return{isLoading:!0,gdocElementId:"gdoc",editLink:$}},mounted:function(){var t=this;O.init(),O.printInfoDoc(this.gdocElementId).then(function(){return t.isLoading=!1}).catch(function(){return t.isLoading=!1})}},N=C,E=n("979c"),x=n("2877");function J(t){this["$style"]=E["default"].locals||E["default"]}var F=Object(x["a"])(N,p,f,!1,J,null,null);F.options.__file="InformationPage.vue";var M=F.exports,R=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"digital-clock"},[t._v("\n  "+t._s(t.hours)+":"+t._s(t.minutes)+":"+t._s(t.seconds)+"\n")])},B=[];n("f576");function P(t,e,n){var i;return n=n||this,function(){for(var a=arguments.length,o=new Array(a),r=0;r<a;r++)o[r]=arguments[r];i&&clearTimeout(i),i=setTimeout(function(){return t.apply(n,o)},e)}}function U(t){return"none"!==window.getComputedStyle(t).display}var V={name:"DigitalClock",data:function(){return{intervalId:null,hours:"",minutes:"",seconds:""}},created:function(){this.handleResize=P(this.handleResize,250)},mounted:function(){this.updateDateTime(),this.startInterval(),this.handleResize(),window.addEventListener("resize",this.handleResize,!1)},beforeDestroy:function(){this.stopInterval(),window.removeEventListener("resize",this.handleResize,!1)},methods:{handleResize:function(){U(this.$el)?this.startInterval():this.stopInterval()},startInterval:function(){this.stopInterval(),this.intervalId=setInterval(this.updateDateTime,1e3)},stopInterval:function(){clearInterval(this.intervalId)},updateDateTime:function(){var t=new Date;this.hours=String(t.getHours()).padStart(2,"0"),this.minutes=String(t.getMinutes()).padStart(2,"0"),this.seconds=String(t.getSeconds()).padStart(2,"0")}}},z=V,H=(n("1436"),Object(x["a"])(z,R,B,!1,null,null,null));H.options.__file="DigitalClock.vue";var q=H.exports,G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("section",{class:t.$style.stationInfo},[n("div",{class:t.$style.form},[n("LocationInput",{attrs:{disabled:t.initializing,label:"Hållplats"}})],1),t.location?n("TripsFilter",{attrs:{dict:t.dict}}):t._e(),n("div",{class:t.$style.content},[n("TripsTable",{attrs:{"from-to-label":t.fromToLabel}}),n("JourneyDetails")],1),t.location?n("footer",{class:t.$style.situations},[n("MessageCarousel",{attrs:{messages:t.situations.messages}})],1):t._e()],1)},Q=[],K=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.$style.carousel},[n("div",{class:t.$style.items,style:{transform:"translateX("+t.translateX+")"},on:{touchstart:t.onTouchStart}},t._l(t.messages,function(e,i){return n("div",{key:i,class:t.$style.item},[t._v("\n      "+t._s(e)+"\n    ")])})),0===t.messages.length?n("div",{class:t.$style.item},[t._v("Inga trafikstörningar.")]):t._e(),n("div",{class:t.$style.dots},[n("button",{class:t.$style.playPauseBtn,on:{click:t.playPause}},[n("font-awesome",{attrs:{icon:["fas",t.intervalId?"pause":"play"]}})],1),t._l(t.messages,function(e,i){return n("button",{key:e,class:t.$style.dotBtn,on:{click:function(e){t.setActive(i)}}},[n("div",{class:[t.$style.dot,(a={},a[t.$style.activeDot]=t.active===i,a)]})]);var a})],2)])},X=[],Y={name:"MessageCarousel",props:{messages:{type:Array,default:function(){return[]}}},data:function(){return{active:0,intervalId:null,wait:5e3}},computed:{translateX:function(){return-100*this.active+"%"}},mounted:function(){this.play()},beforeDestroy:function(){this.pause()},methods:{setActive:function(t){this.pause(),this.active=t,this.play()},selectNextActive:function(){this.active=(this.active+1)%this.messages.length},play:function(){this.intervalId=setInterval(this.selectNextActive,this.wait)},pause:function(){clearInterval(this.intervalId),this.intervalId=null},playPause:function(){this.intervalId?this.pause():this.play()},onTouchStart:function(t){var e=this,n=t.target,i=t.changedTouches[0].clientX,a=function t(a){n.removeEventListener("touchend",t);var o=a.changedTouches[0].clientX,r=i-o,s=Math.abs(r)>50;s&&(r>0?e.setActive((e.active+1)%e.messages.length):e.setActive(e.active>0?e.active-1:e.messages.length-1))};n.addEventListener("touchend",a)}}},W=Y,Z=n("a55e");function tt(t){this["$style"]=Z["default"].locals||Z["default"]}var et=Object(x["a"])(W,K,X,!1,tt,null,null);et.options.__file="MessageCarousel.vue";var nt=et.exports,it=function(){var t,e=this,n=e.$createElement,i=e._self._c||n;return i("aside",{class:[e.$style.journeyDetails,(t={},t[e.$style.display]=e.showJourneyDetails,t)]},[i("header",{class:e.$style.header},[i("h2",{class:e.$style.heading},[e._v("Detaljer")]),e.loadingJourneyDetails?i("font-awesome",{attrs:{icon:"spinner",spin:""}}):e._e(),i("button",{class:e.$style.closeBtn,on:{click:function(t){t.preventDefault(),e.setShowJourneyDetails(!1)}}},[e._v("✗")])],1),i("p",{class:e.$style.journeyMeta},[e.loadingJourneyDetails?e._e():i("span",[e._v("\n      "+e._s(e.journey.name)+" mot "+e._s(e.journey.direction)+"\n    ")]),i("a",{class:e.$style.mapLink,attrs:{href:"#"},on:{click:function(t){t.preventDefault(),e.setCurrentTab("Karta")}}},[e._v("Visa på karta")])]),e.loadingJourneyDetails?e._e():i("div",{class:e.$style.stopList},e._l(e.stops,function(t){return i("div",{key:t.depTime+t.name,class:[e.$style.stop,(n={},n[e.$style.stopPassed]=t.didPass,n)]},[i("div",{class:e.$style.stopDotCell},[i("div",{class:e.$style.stopDot})]),i("div",{class:e.$style.stopTime},[e._v("\n        "+e._s(t.rtDepTime||t.depTime)+"\n      ")]),i("div",{class:e.$style.stopName},[e._v(e._s(t.name))]),i("div",{class:e.$style.stopTrack},[e._v(e._s(t.track))])]);var n}))])},at=[],ot={name:"JourneyDetails",data:function(){return{now:Date.now(),timeoutId:null}},mounted:function(){var t=this;this.timeoutId=setInterval(function(){t.now=Date.now()},3e4)},beforeDestroy:function(){clearInterval(this.timeoutId)},computed:Object(u["a"])({},Object(l["e"])(["showJourneyDetails","loadingJourneyDetails","selectedJourney"]),{journey:function(){var t=this.selectedJourney;if(!t)return{};var e=[].concat(t.JourneyName);if(0===e.length)return{};var n=[].concat(t.Direction);return{name:e[0].name,direction:n[n.length-1].$}},stops:function(){var t=this,e=this.selectedJourney;return e?e.Stop.map(function(e){var n=new Date("".concat(e.depDate,"T").concat(e.depTime)).getTime();return Object(u["a"])({},e,{didPass:n<t.now})}):[]}}),methods:Object(u["a"])({},Object(l["d"])(["setShowJourneyDetails"]),Object(l["d"])("tabs",["setCurrentTab"]))},rt=ot,st=n("67f8");function ct(t){this["$style"]=st["default"].locals||st["default"]}var ut=Object(x["a"])(rt,it,at,!1,ct,null,null);ut.options.__file="JourneyDetails.vue";var lt=ut.exports,pt=function(){var t,e=this,n=e.$createElement,i=e._self._c||n;return i("div",{class:[e.$style.locationInput,(t={},t[e.$style.withLabel]=e.label,t)],on:{focus:e.showDropDown,keyup:function(t){return"button"in t||!e._k(t.keyCode,"esc",27,t.key,"Escape")?e.hideDropDown(t):null}}},[i("label",[e._v("\n    "+e._s(e.label)+":\n    "),i("input",{directives:[{name:"model",rawName:"v-model",value:e.searchText,expression:"searchText"}],attrs:{disabled:e.disabled,type:"search",placeholder:""},domProps:{value:e.searchText},on:{input:[function(t){t.target.composing||(e.searchText=t.target.value)},e.onInput],focus:e.showDropDown,blur:e.possiblyHideDropDown,keyup:[function(t){return"button"in t||!e._k(t.keyCode,"enter",13,t.key,"Enter")?e.selectFirstSuggestion(t):null},e.handleKeyInput]}}),e.isLoading?i("font-awesome",{class:e.$style.spinner,attrs:{icon:"spinner",spin:"","aria-hidden":"true"}}):e._e(),e.selectedLocation?i("Button",{class:e.$style.resetLocationBtn,attrs:{onClick:e.resetLocation,icon:"times"}}):e._e()],1),i("ul",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"show"}],class:e.$style.suggestions},[e.showUseMyLocation?i("li",{class:e.$style.suggestion,on:{keyup:e.handleKeyInput}},[i("button",{on:{click:function(t){return t.preventDefault(),e.getNearbyStops(t)}}},[i("font-awesome",{attrs:{icon:"crosshairs"}}),i("span",[e._v(" "+e._s(e.nearbyStopsMessage)+" ")]),e.isLoadingNearbyStops?i("font-awesome",{attrs:{icon:"spinner",spin:""}}):e._e()],1)]):e._e(),e._l(e.nearbyStops,function(t){return e.showNearbyStops?i("li",{key:t.name,class:e.$style.suggestion,on:{keyup:e.handleKeyInput}},[i("button",{on:{click:function(n){n.preventDefault(),e.onSelect(t)},keyup:function(n){if(!("button"in n)&&e._k(n.keyCode,"space",32,n.key," "))return null;e.onSelect(t)}}},[e._v(e._s(t.name))])]):e._e()}),!e.searchText||e.stops.length||e.isLoading?e._e():i("li",{class:e.$style.suggestion},[i("button",{on:{click:function(t){t.preventDefault()}}},[e._v("Inga resultat för söktermen")])]),e._l(e.stops,function(t){return i("li",{key:t.id,class:e.$style.suggestion,on:{keyup:e.handleKeyInput}},[i("button",{on:{click:function(n){n.preventDefault(),e.onSelect(t)},keyup:function(n){if(!("button"in n)&&e._k(n.keyCode,"space",32,n.key," "))return null;e.onSelect(t)}}},[e._v(e._s(t.name))])])})],2)])},ft=[],dt=(n("6762"),n("2fdb"),function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("button",{class:[t.$style.button,t.className],attrs:{type:t.type,title:t.title},on:{click:function(e){return e.preventDefault(),t.onClick(e)}}},[t._v("\n  "+t._s(t.text)+"\n  "),t.icon?n("font-awesome",{attrs:{icon:["fas",t.icon]}}):t._e()],1)}),mt=[],vt={name:"Button",props:{className:{type:String,default:""},type:{type:String,default:"button"},title:{type:String,default:""},onClick:{type:Function,default:function(){}},text:{type:String,default:""},icon:{type:String,default:null}}},ht=vt,gt=n("8f6b");function bt(t){this["$style"]=gt["default"].locals||gt["default"]}var yt=Object(x["a"])(ht,dt,mt,!1,bt,null,null);yt.options.__file="Button.vue";var _t=yt.exports,Tt={name:"LocationInput",mounted:function(){this.debouncedFindStops=P(this.findStops,350,this),this.selectedLocation&&(this.searchText=this.selectedLocation.name,this.debouncedFindStops(this.selectedLocation.name))},components:{Button:_t},props:{label:{type:String,default:""},disabled:{type:Boolean,default:!1}},data:function(){return{show:!1,searchText:""}},computed:Object(u["a"])({},Object(l["c"])("api",["api"]),Object(l["c"])({isLoadingNearbyStops:"user/isLoading"}),Object(l["e"])("user",["nearbyStops","nearbyStopsError"]),Object(l["e"])("stops",["stops","isLoading"]),Object(l["e"])({userLocation:function(t){var e=t.user;return e.location},selectedLocation:function(t){var e=t.trips;return e.location}}),{nearbyStopsMessage:function(){return this.isLoadingNearbyStops?"Hämtar närliggande hållplatser":this.nearbyStopsError||"Använd min plats"},showUseMyLocation:function(){return!this.searchText&&!this.nearbyStops.length},showNearbyStops:function(){return!this.searchText&&this.nearbyStops.length},hasSuggestions:function(){return this.stops.length||this.nearbyStops.length}}),watch:{selectedLocation:function(t){t||(this.searchText="")}},methods:Object(u["a"])({},Object(l["b"])("user",["getUserLocation","getNearbyStops"]),Object(l["b"])("stops",["findStops"]),Object(l["b"])("trips",["updateLocation"]),{onInput:function(t){var e=t.target.value;this.debouncedFindStops(e)},onSelect:function(t){this.searchText=t.name,this.updateLocation(t),this.hideDropDown(),this.findStops(t.name).then(this.hideDropDown)},selectFirstSuggestion:function(){0!==this.stops.length&&this.onSelect(this.stops[0])},handleKeyInput:function(t){var e={ArrowUp:"previousElementSibling",ArrowDown:"nextElementSibling"},n="button",i=function(n){return n.parentElement[e[t.key]]};if(["ArrowDown","ArrowUp"].includes(t.key)&&this.show&&this.hasSuggestions){var a=this.$el.querySelector(".".concat(this.$style.suggestions," ").concat(n,":focus"));if(a){var o=i(a);o&&o.querySelector(n).focus()}else this.$el.querySelector(".".concat(this.$style.suggestions," ").concat(n)).focus()}},showDropDown:function(){this.show=!0},hideDropDown:function(){this.show=!1,document.activeElement.blur()},possiblyHideDropDown:function(t){t.relatedTarget&&this.$el.contains(t.relatedTarget)||this.hideDropDown()},resetLocation:function(){this.updateLocation(null)}})},Lt=Tt,St=n("c11a");function wt(t){this["$style"]=St["default"].locals||St["default"]}var Dt=Object(x["a"])(Lt,pt,ft,!1,wt,null,null);Dt.options.__file="LocationInput.vue";var kt,jt,At=Dt.exports,It=function(){var t,e=this,n=e.$createElement,i=e._self._c||n;return i("div",{class:[e.$style.tripsTable,(t={},t[e.$style.VT]="VT"===e.apiName,t[e.$style.TV]="TV"===e.apiName,t[e.$style.SL]="SL"===e.apiName,t[e.$style.showingJourneyDetails]=e.showJourneyDetails,t)]},[i("table",{class:e.$style.table},[i("thead",{class:e.$style.tableHead},[i("tr",[i("th",[e._v(e._s(e.metaLabel))]),i("th",[e._v(e._s(e.fromToLabel))]),i("th",[e._v("Tid")]),i("th",{class:e.$style.tripNewTime},[e._v("Ny tid")]),i("th",[e._v(e._s(e.trackLabel))]),i("th",[e._v("Anm")])])]),i("tbody",{class:e.$style.tableBody},[i("tr",{directives:[{name:"show",rawName:"v-show",value:e.isLoading,expression:"isLoading"}]},[i("td",{attrs:{colspan:"5"}},[e._v("\n          Hämtar trafikdata...\n          "),i("font-awesome",{attrs:{icon:"spinner",spin:""}})],1)]),e._l(e.trips,function(t){return i("tr",{key:t.id,class:[e.$style.trip],on:{click:function(n){e.getJourneyDetails(t)}}},[i("td",{class:e.$style.tripLine,style:{backgroundColor:t.fgColor,color:t.bgColor}},[e._v("\n          "+e._s(t.sname)+"\n        ")]),i("td",{class:e.$style.tripDest},[i("div",[i("span",{class:e.$style.tripName},[e._v("\n              "+e._s(t.direction||t.origin)+"\n            ")])]),i("div",{class:e.$style.tripVia},[t.via?i("small",[e._v(" via "+e._s(t.via))]):e._e()])]),i("td",{class:e.$style.tripTime},[i("span",{class:["only-mobile",(n={},n[e.$style.isLate]=t.isLate,n)]},[e._v(e._s(t.rtTime||t.time))]),i("span",{staticClass:"from-tablet"},[e._v(e._s(t.time))])]),i("td",{class:[e.$style.tripNewTime,e.$style.isLate]},[t.isLate?i("span",[e._v(e._s(t.rtTime))]):e._e()]),i("td",{class:e.$style.tripTrack},[e._v(e._s(t.track))]),i("td",{class:e.$style.tripNote},[t.cancelled?i("span",[e._v("Inställd")]):e._e()])]);var n}),i("tr",{directives:[{name:"show",rawName:"v-show",value:!e.isLoading&&e.location&&0===e.trips.length,expression:"!isLoading && location && trips.length === 0"}]},[i("td",{attrs:{colspan:"5"}},[e._v("Inga resor att visa")])])],2)])])},Ot=[],$t="speechSynthesis"in window;function Ct(){kt=window.speechSynthesis.getVoices(),jt=kt.find(function(t){return/Alva/i.test(t.name)})}function Nt(t){if($t){var e=new SpeechSynthesisUtterance;e.text=t,e.volume=1,e.rate=.9,e.pitch=1,jt?e.voice=jt:console.log("Could not select voice"),window.speechSynthesis.speak(e)}}$t&&Ct(),window.speechSynthesis.onvoiceschanged=Ct;var Et={name:"TripsTable",props:{fromToLabel:{type:String,default:""}},mounted:function(){this.speak=P(this.speak,250,this)},computed:Object(u["a"])({},Object(l["e"])({showJourneyDetails:function(t){return t.showJourneyDetails},apiName:function(t){var e=t.api;return e.name}}),Object(l["e"])("trips",{isLoading:function(t){var e=t.isLoading;return e},location:function(t){var e=t.location;return e},doSpeak:function(t){var e=t.options;return e.voice}}),Object(l["c"])({trips:"trips/filteredTrips"}),Object(l["c"])("api",["dict"]),{metaLabel:function(){return this.dict.sname},trackLabel:function(){return this.dict.track}}),watch:{trips:function(t){this.speak(t)}},methods:Object(u["a"])({},Object(l["b"])(["getJourneyDetails"]),{speak:function(t){if(!(t.length<1)&&this.doSpeak){var e=t[0],n=e.name,i=e.direction,a=e.timestamp,o=e.cancelled,r=t[0].via&&"via ".concat(t[0].via,",")||"",s=Math.ceil((a-Date.now())/6e4);Nt(o?"".concat(n," mot ").concat(i,", ").concat(r," är inställd"):s<=0?"".concat(n," mot ").concat(i,", ").concat(r," avgår nu"):1===s?"".concat(n," mot ").concat(i,", ").concat(r," avgår om en minut"):s>1&&s<=60?"".concat(n," mot ").concat(i,", ").concat(r," avgår om ").concat(s," minuter"):"".concat(n," mot ").concat(i,", ").concat(r," avgår om mer än en timma"))}}})},xt=Et,Jt=n("55a3");function Ft(t){this["$style"]=Jt["default"].locals||Jt["default"]}var Mt=Object(x["a"])(xt,It,Ot,!1,Ft,null,null);Mt.options.__file="TripsTable.vue";var Rt=Mt.exports,Bt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.$style.tripsFilter},[n("div",{class:t.$style.filter},[n("font-awesome",{staticClass:"only-mobile",attrs:{icon:"filter"}}),n("span",{staticClass:"from-tablet"},[t._v("Filter:")])],1),n("div",{class:t.$style.filter},[n("select",{attrs:{name:"dest"},on:{change:t.updateFilter}},[n("option",{attrs:{value:""}},[t._v(t._s(t.fromToLabel))]),t._l(t.destinations,function(e){return n("option",{key:e,domProps:{selected:t.filter.dest===e,value:e}},[t._v(t._s(e))])})],2)]),n("div",{class:t.$style.filter},[n("select",{attrs:{name:"track"},on:{change:t.updateFilter}},[n("option",{attrs:{value:""}},[t._v("Läge")]),t._l(t.tracks,function(e){return n("option",{key:e,domProps:{selected:t.filter.track===e,value:e}},[t._v(t._s(e))])})],2)]),n("div",{class:t.$style.filter},[n("label",{class:t.$style.voice},[n("font-awesome",{attrs:{icon:["fas",t.options.voice?"volume-up":"volume-off"]}}),n("input",{class:t.$style.voiceCheckbox,attrs:{type:"checkbox",name:"voice"},domProps:{checked:t.options.voice},on:{input:t.updateOption}})],1)]),n("div",{class:t.$style.filter},[n("button",{class:t.$style.refreshBtn,attrs:{title:"Uppdatera"},on:{click:function(e){e.preventDefault(),t.getTrips()}}},[n("font-awesome",{attrs:{icon:"sync"}})],1)])])},Pt=[];n("55dd"),n("ac6a"),n("4f7f"),n("1c4c"),n("c5f6");function Ut(t,e){var n=Number(t)||t.charCodeAt(0),i=Number(e)||e.charCodeAt(0);return n<i?-1:n>i?1:0}var Vt=n("a322");function zt(t){if(!(t instanceof HTMLElement))throw Error("Argument must be HTMLElement");var e=t.nodeName,n=t.name;if("SELECT"===e)return Object(Vt["a"])({},n,t.selectedOptions[0].value);if("INPUT"===e){var i=["checkbox","radio"].includes(t.type)?t.checked:t.value;return Object(Vt["a"])({},n,i)}throw Error("Unhandled node type: ".concat(t.nodeName))}var Ht={name:"TripsFilter",props:{dict:{type:Object,default:function(){return{}}}},data:function(){return{radio:!1,timeSpans:[{value:"30",name:"30 min"},{value:"60",name:"1 timme"},{value:"120",name:"2 timmar"},{value:"180",name:"3 timmar"},{value:"360",name:"6 timmar"},{value:"720",name:"12 timmar"},{value:"1440",name:"24 timmar"}]}},computed:Object(u["a"])({},Object(l["e"])("trips",["filter","options"]),Object(l["c"])({trips:"trips/filteredTrips"}),{fromToLabel:function(){return this.dict.origDest},arriveDepartLabel:function(){return this.dict.arrEaves},destinations:function(){return Array.from(new Set(this.trips.map(function(t){var e=t.direction,n=t.origin;return e||n})))},tracks:function(){var t=this.trips.map(function(t){var e=t.track;return e}).filter(function(t){return t}).map(String);return Array.from(new Set(t)).sort(Ut)}}),methods:Object(u["a"])({},Object(l["d"])("trips",["setFilter","setOptions"]),Object(l["b"])("trips",["getTrips"]),{updateFilter:function(t){var e=t.target,n=zt(e);n&&this.setFilter(n)},updateOption:function(t){var e=t.target,n=zt(e);n&&this.setOptions(n)}})},qt=Ht,Gt=n("2f3b");function Qt(t){this["$style"]=Gt["default"].locals||Gt["default"]}var Kt=Object(x["a"])(qt,Bt,Pt,!1,Qt,null,null);Kt.options.__file="TripsFilter.vue";var Xt=Kt.exports,Yt={arrival:{arrEaves:"Ankommer",origDest:"Från"},departure:{arrEaves:"Avgår",origDest:"Till"}},Wt={name:"StationInfo",components:{LocationInput:At,JourneyDetails:lt,TripsTable:Rt,TripsFilter:Xt,MessageCarousel:nt},props:{arrivals:{type:Boolean,default:!1}},computed:Object(u["a"])({},Object(l["e"])("trips",["location","situations"]),Object(l["e"])("api",{apiName:function(t){var e=t.name;return e},initializing:function(t){var e=t.initializing;return e}}),Object(l["c"])("api",["api"]),{dict:function(){return this.arrivals?Yt.arrival:Yt.departure},show:function(){return!!this.trips.length},fromToLabel:function(){return this.arrivals?"Från":"Till"},arriveDepartLabel:function(){return this.arrivals?"Ankommer":"Avgår"}}),watch:{arrivals:function(t,e){t!==e&&this.location&&this.getTrips(this.location)},apiName:function(t,e){t!==e&&clearTimeout(this.lastTimeoutId)}},beforeDestroy:function(){clearTimeout(this.lastTimeoutId)},methods:Object(u["a"])({},Object(l["b"])("trips",["getTrips"]))},Zt=Wt,te=n("aeaf");function ee(t){this["$style"]=te["default"].locals||te["default"]}var ne=Object(x["a"])(Zt,G,Q,!1,ee,null,null);ne.options.__file="StationInfo.vue";var ie=ne.exports,ae=function(){var t,e=this,n=e.$createElement,i=e._self._c||n;return i("div",{class:[e.$style.updateAvailable,(t={},t[e.$style.updateAvailableActive]=e.hasUpdate,t)]},[e._v("\n  🎉"),i("strong",[e._v("Uppdatering tillgänglig")]),e._v(" 🎉"),i("br"),i("a",{class:e.$style.reloadLink,attrs:{href:"#"},on:{click:function(t){return t.preventDefault(),e.reload(t)}}},[e._v("Ladda om")]),e._v(" för att uppdatera 😆\n  "),i("Button",{attrs:{icon:"times",className:e.$style.closeBtn,onClick:e.closeUpdateToaster,title:"Stäng"}})],1)},oe=[],re={name:"UpdateAvailable",components:{Button:_t},computed:Object(u["a"])({},Object(l["e"])({hasUpdate:function(t){return t.updateAvailable}})),methods:Object(u["a"])({},Object(l["d"])(["setUpdateAvailable"]),{closeUpdateToaster:function(){this.setUpdateAvailable(!1)},reload:function(){window.location.reload()}})},se=re,ce=n("23f2");function ue(t){this["$style"]=ce["default"].locals||ce["default"]}var le=Object(x["a"])(se,ae,oe,!1,ue,null,null);le.options.__file="UpdateAvailable.vue";var pe=le.exports,fe=function(){var t=this,e=t.$createElement,n=t._self._c||e;return t.isOnline?t._e():n("div",{class:t.$style.offlineIndicator},[t._v("\n  Ingen internetanslutning 😥\n")])},de=[],me={name:"OfflineIndicator",computed:Object(u["a"])({},Object(l["e"])({isOnline:function(t){return t.online}}))},ve=me,he=n("699f");function ge(t){this["$style"]=he["default"].locals||he["default"]}var be=Object(x["a"])(ve,fe,de,!1,ge,null,null);be.options.__file="OfflineIndicator.vue";var ye=be.exports,_e=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ul",{class:t.$style.tabs},t._l(t.tabs,function(e){return n("li",{key:e.name,class:[t.$style.tab,e.className,(i={},i[t.$style.tabSmall]=e.small,i[t.$style.tabActive]=t.currentTab===e.name,i[t.$style.tabDisabled]=e.disabled,i)]},[n("a",{class:t.$style.link,attrs:{title:e.name,href:"#"},on:{click:function(t){t.preventDefault(),e.onClick(e.name,e.props.arrivals)}}},[e.icon?n("font-awesome",{class:t.$style.onlyMobile,attrs:{icon:e.icon}}):t._e(),e.initializing?t._e():n("span",{class:(a={},a[t.$style.onlyDesktop]=e.icon,a)},[t._v("\n        "+t._s(e.name)+"\n      ")]),e.initializing?n("font-awesome",{attrs:{icon:"spinner",spin:""}}):t._e()],1)]);var i,a}))},Te=[],Le={name:"TabsComponent",props:{tabs:{type:Array,default:function(){return[]}},onClick:{type:Function,default:function(){}},currentTab:{type:String,default:""}}},Se=Le,we=n("6f5f");function De(t){this["$style"]=we["default"].locals||we["default"]}var ke=Object(x["a"])(Se,_e,Te,!1,De,null,null);ke.options.__file="Tabs.vue";var je=ke.exports,Ae={icon:"",className:"",props:{arrivals:!1},onClick:function(){}},Ie=[{name:"Avgångar",componentName:"station-info"},{name:"Ankomster",componentName:"station-info",props:{arrivals:!0}},{name:"Karta",componentName:"map-component",icon:"map"},{name:"Info",componentName:"information-page",icon:"info-circle"}],Oe={name:"App",components:{MapComponent:function(){return n.e("chunk-4edf4bfa").then(n.bind(null,"a0be"))},Tabs:je,StationInfo:ie,DigitalClock:q,UpdateAvailable:pe,InformationPage:M,OfflineIndicator:ye},data:function(){return{buildTime:"Sun, 28 Oct 2018 11:17:32 GMT",timeoutId:null}},mounted:function(){this.location&&this.getTripsAgainAndAgain()},computed:Object(u["a"])({},Object(l["e"])({apiName:function(t){var e=t.api;return e.name},initializing:function(t){var e=t.api;return e.initializing}}),Object(l["e"])("tabs",["currentTab"]),Object(l["e"])("trips",["location"]),Object(l["c"])("api",["api"]),{tabs:function(){var t=this;return[Object(u["a"])({},Ae,{name:this.apiName,small:!0,onClick:this.toggleApi,initializing:this.initializing,className:this.apiName})].concat(Object(c["a"])(Ie.map(function(e){return Object(u["a"])({},Ae,e,{disabled:e.props&&e.props.arrivals&&"function"!==typeof t.api.getArrivalsTo,onClick:t.changeTab})})))},currentTabComponent:function(){var t=this;return this.tabs.find(function(e){var n=e.name;return n===t.currentTab})}}),watch:{location:function(t,e){t?t.id!==(e&&e.id)&&(clearTimeout(this.timeoutId),this.getTripsAgainAndAgain()):clearTimeout(this.timeoutId)},apiName:function(){"Ankomster"===this.currentTab&&"function"!==typeof this.api.getArrivalsTo&&this.setCurrentTab("Avgångar")}},methods:Object(u["a"])({},Object(l["d"])("trips",["setArrivals"]),Object(l["d"])("tabs",["setCurrentTab"]),Object(l["b"])("api",["toggleApi"]),Object(l["b"])("trips",["getTrips"]),{changeTab:function(t,e){this.setArrivals(e),this.setCurrentTab(t)},getTripsAgainAndAgain:function(){var t=this;window.requestAnimationFrame(function(){t.getTrips(),t.timeoutId=setTimeout(function(){return t.getTripsAgainAndAgain()},3e4)})}})},$e=Oe,Ce=(n("034f"),Object(x["a"])($e,r,s,!1,null,null,null));Ce.options.__file="App.vue";var Ne=Ce.exports,Ee=n("bfa9"),xe=(n("f751"),'<LOGIN authenticationkey="2dfa6ea579bd45e3ac3810eb1a97adb6" />'),Je={},Fe={TrainStation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.lat,n=t.long,i=t.name,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;return i?'\n        <FILTER>\n          <AND>\n            <LIKE name="AdvertisedLocationName" value="/^'.concat(i,'/" />\n            <EQ name="Advertised" value="true" />\n          </AND>\n        </FILTER>\n      '):e&&n?'\n        <FILTER>\n          <AND>\n            <WITHIN name="Geometry.WGS84" shape="center" value="'.concat(n," ").concat(e,'" radius="').concat(a,'m" />\n            <EQ name="Advertised" value="true" />\n          </AND>\n        </FILTER>\n      '):"<FILTER />"},TrainMessage:function(t){return'\n      <FILTER>\n        <EQ name="AffectedLocation" value="'.concat(t,'" />\n      </FILTER>\n    ')},TrainAnnouncement:function(t){return'\n      <FILTER>\n        <AND>\n          <EQ name="Advertised" value="true" />\n          <EQ name="ActivityType" value="Avgang" />\n          <EQ name="LocationSignature" value="'.concat(t,'" />\n          <GT name="AdvertisedTimeAtLocation" value="$dateadd(00:00:00)" />\n          <LT name="AdvertisedTimeAtLocation" value="$dateadd(05:00:00)" />\n        </AND>\n      </FILTER>\n    ')}};function Me(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return fetch("https://api.trafikinfo.trafikverket.se/v1.3/data.json",{body:"\n      <REQUEST>\n        ".concat(xe,'\n        <QUERY objecttype="').concat(t,'" ').concat("TrainAnnouncement"===t?'orderby="AdvertisedTimeAtLocation"':"",">\n          ").concat(Fe[t].apply(Fe,n),"\n        </QUERY>\n      </REQUEST>\n    "),method:"POST",mode:"cors",headers:{"Content-Type":"text/xml"}}).then(function(t){var e=t.json().then(function(t){return t.RESPONSE.RESULT});return t.ok?e:e.then(function(t){return Promise.reject(t)})}).then(function(e){return e[0][t]||[]}).catch(function(t){return console.error(t)})}function Re(t){return console.log(t||"No results"),t}function Be(t){return Object.assign({},t,{name:t.AdvertisedLocationName,id:t.LocationSignature,region:"TV"})}function Pe(t){var e=t.lat,n=t.lng;return Me("TrainStation",{lat:e,long:n},5e3).then(function(t){return t.slice(0,5).map(Be)})}var Ue,Ve,ze={init:function(){return Me("TrainStation").then(function(t){return t.forEach(function(t){Je[t.LocationSignature]=t.AdvertisedLocationName})})},getClosestStops:Pe,getClosestStop:function(t){return Pe(t).then(function(t){return t[0]})},getTrafficSituations:function(t){return Me("TrainMessage",t).then(Re).then(function(t){return{messages:t.map(function(t){var e=t.ExternalDescription;return e})}})},getDeparturesFrom:function(t){return Me("TrainAnnouncement",t).then(function(t){return(t||[]).slice(0,30)}).then(Re).then(function(t){return t.map(function(t){return Object(u["a"])({},t,{id:t.ActivityId,direction:t.ToLocation&&(Je[t.ToLocation[0].LocationName]||""),via:t.ViaToLocation&&(Je[t.ViaToLocation[0].LocationName]||""),name:"".concat(t.ProductInformation.join(" ")),time:t.AdvertisedTimeAtLocation.substr(-8,5),timestamp:new Date(t.AdvertisedTimeAtLocation).getTime(),isLate:!1,track:t.TrackAtLocation,sname:t.ProductInformation[0]})})})},findStops:function(t){return Me("TrainStation",{name:t}).then(function(t){return t.slice(0,15).map(Be)})},stationMap:Je},He=(n("20d6"),"https://api.vasttrafik.se/bin/rest.exe/v2"),qe="https://api.vasttrafik.se/ts/v1/traffic-situations";function Ge(t,e){var n=e?"".concat(qe,"/").concat(e,"/").concat(t):qe;return an(n,{Accept:"application/json"}).then(function(t){return t.reduce(function(t,e){var n=e.title,i=e.description,a=e.affectedLines;return{messages:t.messages.concat("".concat(n," ").concat(i)),affectedLines:[].concat(t.affectedLines,a.map(function(t){var e=t.designation;return e})).filter(function(t){return t})}},{messages:[]})})}function Qe(t,e){var n=new Date,i=n.toISOString().substr(0,10),a=n.toLocaleTimeString().substr(0,5),o="".concat(He,"/trip?originId=").concat(t,"&destId=").concat(e,"&date=").concat(i,"&time=").concat(a,"&format=json");return an(o).then(function(t){return cn(t.TripList.Trip).map(function(t){return cn(t.Leg)})})}function Ke(t){var e="".concat(He,"/location.name?input=").concat(encodeURIComponent(t),"&format=json");return an(e).then(function(t){return cn(t.LocationList.StopLocation).slice(0,5)}).then(function(t){return t.map(function(t){return Object.assign({},t,{region:"VT"})})})}function Xe(t){return t.map(function(t){var e=t.rtTime&&t.rtTime!==t.time,n=t.rtTime||t.time,i=t.rtDate||t.date,a=t.bgColor||"white",o=new Date("".concat(i,"T").concat(n)).getTime();return Object.assign({},t,{region:"VT",cancelled:Boolean(t.cancelled),isLate:e,bgColor:a,timestamp:o})})}function Ye(t,e){var n=new Date,i=n.toISOString().substr(0,10),a=n.toLocaleTimeString().substr(0,5),o="".concat(He,"/arrivalBoard?id=").concat(encodeURIComponent(t),"&date=").concat(encodeURIComponent(i),"&time=").concat(encodeURIComponent(a),"&format=json");return e&&(o="".concat(o,"&timeSpan=").concat(e)),Ze(t,o).then(function(t){return t.ArrivalBoard.Arrival}).then(Xe)}function We(t,e){var n="".concat(He,"/departureBoard?id=").concat(encodeURIComponent(t),"&format=json");return e&&(n="".concat(n,"&timeSpan=").concat(e)),Ze(t,n).then(function(t){return t.DepartureBoard.Departure||[]}).then(function(t){return t.filter(function(e,n){var i=e.journeyid;return!t.slice(0,n).some(function(t){return t.journeyid===i})})}).then(Xe)}function Ze(t,e){return an(e).then(function(t){var e=t.error,n=t.errorText;return(e||n)&&console.error("[getTimeTable]",e||n),t})}function tn(t){var e=t.south,n=t.west,i=t.north,a=t.east,o=function(t){return Math.round(1e6*t)},r="".concat(He,"/livemap?minx=").concat(o(n),"&miny=").concat(o(e),"&maxx=").concat(o(a),"&maxy=").concat(o(i),"&onlyRealtime=yes");return an(r).then(function(t){var e=t.livemap;return e.vehicles})}function en(t){return an(t).then(function(t){var e=t.JourneyDetail;return e})}function nn(t){return an(t).then(function(t){var e=t.Geometry;return e})}function an(t,e){var n=Promise.resolve(),i=Object(u["a"])({},e,{Authorization:"Bearer ".concat(Ue)});return(!Ve||Ve.getTime()<Date.now())&&(console.log("Need to update authtoken"),n.then(rn)),n.then(function(){return fetch(t,{headers:i})}).then(sn)}function on(t){var e=t.lat,n=t.lng,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o="".concat(He,"/location.nearbystops?originCoordLat=").concat(e,"&originCoordLong=").concat(n,"&maxNo=").concat(2*i,"&format=json");return an(o).then(function(t){if(t.LocationList.errorText)throw new Error(t.LocationList.errorText);return t.LocationList.StopLocation?t.LocationList.StopLocation.filter(function(t,e,n){var i=t.name,a=n.findIndex(function(t){return t.name===i});return a===e}).map(function(t){return Object(u["a"])({},t,{region:"VT"})}).slice(0,i):[]}).catch(function(t){if(!a)throw console.error("[getClosestStops]",t),t;console.error("[getClosestStops]:",t,"retrying"),on({lat:e,lng:n},i,!1)})}function rn(){return fetch("https://api.vasttrafik.se:443/token",{headers:{Authorization:"Basic b1pZclV2c1ZGTG8zZ2FSemNaS0NUbEdJX21ZYTo4bTlLNnFsaDVNQXBWRFdRYlVWSUhneWZja3dh","Content-Type":"application/x-www-form-urlencoded"},method:"POST",body:"grant_type=client_credentials"}).then(sn).then(function(t){return Ue=t.access_token,Ve=new Date(Date.now()+1e3*t.expires_in),console.log("AuthToken expires ".concat(Ve.toLocaleString())),t.access_token})}function sn(t){return t.ok?t.json():t.json().then(function(t){return Promise.reject(t)})}function cn(t){return t?[].concat(t):[]}var un=rn();function ln(){return un}var pn={init:ln,getClosestStop:function(t){return on(t,1)},getClosestStops:on,findStops:Ke,getGeometry:nn,getJourneyDetail:en,getTripSuggestion:Qe,getDeparturesFrom:We,getArrivalsTo:Ye,getTrafficSituations:Ge,getLiveMap:tn,transformTrips:Xe},fn="http://api.sl.se/api2",dn={method:"GET"},mn={7:"gray",10:"#1C7F2A",11:"#1C7F2A",12:"gray",13:"#D51427",14:"#D51427",17:"#60A42B",18:"#60A42B",19:"#60A42B",21:"brown",22:"orange",25:"turquoise",26:"turquoise",27:"purple",28:"purple",29:"purple",40:"pink",41:"pink",42:"pink",43:"pink",44:"pink",45:"pink",48:"pink"};function vn(t){return mn[t]||"#A4A5A7"}function hn(t){return Object(u["a"])({},t,{HafasId:t.id,id:t.id.substr(-4),region:"SL"})}function gn(t){var e=t.lat,n=t.lng,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:5,a="bf8e1f49392843a19e86ef1ccbaa15a0",o="nearbystops.json?key=".concat(a,"&originCoordLat=").concat(e,"&originCoordLong=").concat(n,"&maxresults=").concat(i);return kn(o).then(function(t){var e=Array.from(t.LocationList.StopLocation);return e.map(hn)})}function bn(t){return gn(t,1)[0]}function yn(t){var e="76ea4bd8c1014b6490418de04bfd0b32",n="typeahead.json?key=".concat(e,"&searchstring=").concat(encodeURIComponent(t),"&maxresults=5");return kn(n).then(function(t){return Dn(t.ResponseData)}).then(function(t){return t.filter(function(e,n){var i=t.findIndex(function(t){var n=t.SiteId;return n===e.SiteId});return i>=n}).slice(0,5).map(function(t){return Object(u["a"])({},t,{name:t.Name,id:t.SiteId,region:"SL"})})})}var _n={BUS:"Buss",METRO:"T-bana",SHIP:"Båt",TRAIN:"Tåg",TRAM:"Spårvagn"};function Tn(t){return _n[t]||t}function Ln(t){var e="a312919085a9447d839109b9a6880d20",n="realtimedeparturesV4.json?key=".concat(e,"&siteid=").concat(t,"&timewindow=30");return kn(n).then(function(t){return Object(c["a"])(t.ResponseData.Buses).concat(Object(c["a"])(t.ResponseData.Metros),Object(c["a"])(t.ResponseData.Ships),Object(c["a"])(t.ResponseData.Trains),Object(c["a"])(t.ResponseData.Trams)).map(function(t){return Object(u["a"])({},t,{fgColor:vn(t.LineNumber),bgColor:"white",direction:t.Destination,timestamp:new Date(t.ExpectedDateTime||t.TimeTabledDateTime).getTime(),time:t.TimeTabledDateTime.substr(11,5),rtTime:t.ExpectedDateTime.substr(11,5),name:"".concat(Tn(t.TransportMode)," ").concat(t.LineNumber),sname:t.LineNumber,track:t.StopPointDesignation||t.JourneyDirection,region:"SL",href:"#",isLate:t.TimeTabledDateTime!==t.ExpectedDateTime})})})}function Sn(t){var e="367eaa6107874c6e86bd985872f9cd46",n="deviations.json?key=".concat(e,"&siteId=").concat(t);return kn(n).then(function(t){return Dn(t.ResponseData)}).then(function(t){return{messages:t.map(function(t){var e=t.Details;return e})}})}function wn(t){return t.ok&&204!==t.status?t.json():t.ok?(console.log("fetchMiddleware: not json and no error"),t):t.json().then(function(t){return Promise.reject(t)})}function Dn(t){return t&&[].concat(t)||[]}function kn(t){var e="".concat(fn,"/").concat(t),n="https://request-proxy.herokuapp.com/?url=".concat(encodeURIComponent(e));return fetch(n,dn).then(wn).catch(function(t){return console.error(t)})}var jn={getClosestStop:bn,getClosestStops:gn,getDeparturesFrom:Ln,getTrafficSituations:Sn,findStops:yn,init:function(){return Promise.resolve()}},An={TV:{track:"Spår",sname:"Anmärkn."},VT:{track:"Läge",sname:"Linje"},SL:{track:"Läge",sname:"Linje"}},In={VT:pn,TV:ze,SL:jn},On={isSupported:"geolocation"in navigator,isLoading:{location:!1,nearbyStops:!1},location:null,consented:null,nearbyStops:[],nearbyStopsError:""},$n={isLoading:function(t){var e=t.isLoading;return e.location||e.nearbyStops}},Cn={getNearbyStops:function(){var t=Object(d["a"])(regeneratorRuntime.mark(function t(e){var n,i,a,o,r;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.commit,i=e.dispatch,a=e.state,o=e.rootState,r=e.rootGetters,a.isSupported){t.next=3;break}return t.abrupt("return");case 3:if(a.location){t.next=6;break}return t.next=6,i("getUserLocation");case 6:n("setLoading",{nearbyStops:!0}),r["api/api"].getClosestStops(a.location).then(function(t){console.log("nearbySyops",t),t&&t.length&&t[0].region===o.api.name?n("setNearbyStops",t):(n("setNearbyStopsError","Hittade ingen närliggande hållplats 😥"),setTimeout(function(){return n("setNearbyStopsError","")},7e3)),n("setLoading",{nearbyStops:!1})}).catch(function(t){console.error(t),n("setLoading",{nearbyStops:!1}),n("setNearbyStopsError","Något gick snett 😱")});case 8:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),getUserLocation:function(t){var e=t.commit,n=t.state;return n.isSupported?(e("setLoading",{location:!0}),new Promise(function(t,e){navigator.geolocation.getCurrentPosition(t,e)}).then(function(t){e("setLoading",{location:!1}),e("setConsented",!0),e("setLocation",t.coords)}).catch(function(t){console.error(t),e("setLoading",{location:!1}),e("setConsented",!1)})):Promise.resolve()}},Nn={setLoading:function(t,e){t.isLoading=Object(u["a"])({},t.loading,e)},setConsented:function(t,e){t.consented=e},setLocation:function(t,e){t.location={lat:e.latitude,lng:e.longitude}},setNearbyStops:function(t,e){t.nearbyStops=e,t.nearbyStopsError=""},setNearbyStopsError:function(t,e){t.nearbyStopsError=e}},En={namespaced:!0,state:On,getters:$n,actions:Cn,mutations:Nn},xn=(n("456d"),n("9393")),Jn=/\s*via\s*/;function Fn(t){if(Jn.test(t.direction)){var e=t.direction.split(Jn),n=Object(xn["a"])(e,2),i=n[0],a=n[1];return Object.assign({},t,{direction:i,via:a})}return t}var Mn,Rn={track:"",dest:"",timeSpan:""},Bn={messages:[],affectedLines:[]},Pn={isLive:!0,voice:!1},Un=Object.keys(Rn),Vn=Object.keys(Pn),zn={arrivals:!1,filter:Object(u["a"])({},Rn),options:Object(u["a"])({},Pn),trips:[],manualTrips:[],situations:Object(u["a"])({},Bn),isLoading:!1,location:null},Hn={filteredTrips:function(t){var e=t.trips,n=t.manualTrips,i=t.location,a=t.filter,o=t.situations,r=a.track,s=a.dest,l=o.affectedLines,p=void 0===l?[]:l,f=Date.now(),d=n.filter(function(t){var e=t.origin;return i&&e===i.name}).filter(function(t){var e=t.timestamp;return e>f});return Object(c["a"])(e).concat(Object(c["a"])(d)).map(function(t){return Object(u["a"])({},t,{isAffected:p.includes(t.sname)})}).filter(function(t){return!r||t.track===r}).filter(function(t){var e=t.direction,n=t.origin;return!s||(e===s||n===s)}).sort(function(t,e){return t.timestamp-e.timestamp})}},qn={loadManualDepartures:function(t){var e=t.commit;O.getManualDepartures().then(function(t){e("setManualTrips",In.VT.transformTrips(t))})},getTrips:function(t){var e=t.commit,n=t.state,i=t.rootGetters,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.location;if(!a)return e("setTrips",[]);var o=n.arrivals?i["api/api"]["getArrivalsTo"]:i["api/api"]["getDeparturesFrom"];return e("setLoading",!0),o(a.id,n.filter.timeSpan).then(function(t){var n=t.map(Fn);console.log("[getTrips]",n),e("setTrips",n),e("setLoading",!1)}).catch(function(t){console.error("[getTrips]",t),e("setLoading",!1)})},getTrafficSituations:function(t,e){var n=t.commit,i=t.rootGetters;return e?i["api/api"].getTrafficSituations(e.id,"stoparea").then(function(t){var e=t.messages.filter(function(t,e,n){return!n.slice(0,e).some(function(e){return e===t})});console.log("situations",t),n("setSituations",Object(u["a"])({},t,{messages:e}))}).catch(function(t){return console.error("[getTrafficSituations]",t)}):n("setSituations",Object(u["a"])({},Bn))},updateLocation:function(t,e){var n=t.dispatch,i=t.commit,a=t.state;a.location!==e&&(console.log("[updateLocation]",e),i("setLocation",e),e?(n("getTrips",e),n("getTrafficSituations",e)):i("reset"))}},Gn={reset:function(t){t.trips=[],t.filter=Object(u["a"])({},Rn),t.location=null,t.situations=Object(u["a"])({},Bn)},setFilter:function(t,e){if(!Object.keys(e).every(function(t){return Un.includes(t)}))return console.error("[setFilter]","Non valid key(s) supplied, must be one of",Un);t.filter=Object(u["a"])({},t.filter,e)},setOptions:function(t,e){if(!Object.keys(e).every(function(t){return Vn.includes(t)}))return console.error("[setOptions]","Non valid key(s) supplied, must be one of",Vn);t.options=Object(u["a"])({},t.options,e)},setTrips:function(t,e){t.trips=e},setManualTrips:function(t,e){t.manualTrips=e},setSituations:function(t,e){t.situations=e},setLoading:function(t,e){t.isLoading=e},setLocation:function(t,e){t.location=e},setArrivals:function(t,e){t.arrivals=e}},Qn={namespaced:!0,state:zn,getters:Hn,actions:qn,mutations:Gn},Kn={stops:[],isLoading:!1},Xn={},Yn={findStops:function(t,e){var n=t.commit,i=t.rootGetters;return e?(Mn=e,n("setLoading",!0),i["api/api"].findStops(e).then(function(t){return console.log("stops",t),Mn===e?(n("setLoading",!1),n("setStops",t)):console.log("skipping response"),t}).catch(function(t){console.error(t),n("setLoading",!1)})):n("setStops",[])}},Wn={setStops:function(t,e){t.stops=e},setLoading:function(t,e){t.isLoading=e}},Zn={namespaced:!0,state:Kn,getters:Xn,actions:Yn,mutations:Wn},ti={currentTab:"Avgångar"},ei={setCurrentTab:function(t,e){t.currentTab=e}},ni={namespaced:!0,state:ti,mutations:ei},ii=Object.keys(In),ai="VT";if(!ii.includes(ai))throw new Error("defaultApi must exist");var oi=[],ri={name:ai,initializing:!0},si={api:function(t){var e=t.name;return In[e]},dict:function(t){var e=t.name;return An[e]}},ci={setApi:function(t,e){t.name=e},setInitializing:function(t,e){t.initializing=e}},ui={initApi:function(t){var e=t.commit,n=t.state;console.info("initializing",n.name),e("setInitializing",!0),In[n.name].init().then(function(){e("setInitializing",!1),oi.push(n.name)}).catch(function(t){console.error("[initApi]",t),e("setInitializing",!1)})},toggleApi:function(t){var e=t.state,n=t.commit,i=t.dispatch,a=ii.indexOf(e.name),o=(a+1)%ii.length,r=ii[o],s=oi.includes(r);n("setApi",r),n("trips/reset",null,{root:!0}),n("stops/setStops",[],{root:!0}),s||i("initApi")}},li={namespaced:!0,state:ri,getters:si,mutations:ci,actions:ui};o["a"].use(l["a"]);var pi=new Ee["a"]({storage:window.localStorage,reducer:function(t){var e=t.trips,n=t.api;return{trips:e,api:n}}}),fi=new l["a"].Store({strict:!1,state:{online:!0,selectedJourney:null,updateAvailable:!1,showJourneyDetails:!1,loadingJourneyDetails:!1},getters:{},mutations:{setOnline:function(t,e){t.online=e},setUpdateAvailable:function(t,e){t.updateAvailable=e},selectJourney:function(t,e){t.selectedJourney=e},setShowJourneyDetails:function(t,e){t.showJourneyDetails=e},setLoadingJourneyDetails:function(t,e){t.loadingJourneyDetails=e}},actions:{getJourneyDetails:function(t,e){var n=t.commit,i=t.state;if("VT"!==i.api.name||!e.JourneyDetailRef)return console.log("[getJourneyDetails]","only available for VT"),Promise.resolve();n("setShowJourneyDetails",!0),n("setLoadingJourneyDetails",!0),In.VT.getJourneyDetail(e.JourneyDetailRef.ref).then(function(t){n("selectJourney",t),n("setLoadingJourneyDetails",!1)}).catch(function(t){console.error("[getJourneyDetails]",t),n("setLoadingJourneyDetails",!1)})}},modules:{api:li,user:En,trips:Qn,stops:Zn,tabs:ni},plugins:[pi.plugin]}),di=n("9483");fi.commit("setOnline",navigator.onLine),window.addEventListener("offline",function(){return fi.commit("setOnline",!1)}),window.addEventListener("online",function(){return fi.commit("setOnline",!0)}),Object(di["a"])("".concat("/rasmus2.0/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},cached:function(){console.log("Content has been cached for offline use.")},updated:function(){fi.commit("setUpdateAvailable",!0),console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(t){console.error("Error during service worker registration:",t)}});var mi=n("ecee"),vi=n("c074"),hi=n("7a55");mi["library"].add(vi["e"],vi["g"],vi["i"],vi["j"],vi["a"],vi["f"],vi["c"],vi["h"],vi["l"],vi["k"],vi["d"],vi["b"]),o["a"].component("font-awesome",hi["FontAwesomeIcon"]),o["a"].config.productionTip=!1,fi.dispatch("api/initApi"),fi.dispatch("trips/loadManualDepartures"),new o["a"]({store:fi,render:function(t){return t(Ne)}}).$mount("#app")},"67f8":function(t,e,n){"use strict";var i=n("add9"),a=n.n(i);e["default"]=a.a},"68f3":function(t,e,n){t.exports={informationPage:"InformationPage_informationPage_2JzFC",editLink:"InformationPage_editLink_3mh2I",spinner:"InformationPage_spinner_3mv-F"}},"699f":function(t,e,n){"use strict";var i=n("e713"),a=n.n(i);e["default"]=a.a},"6f5f":function(t,e,n){"use strict";var i=n("9dcf"),a=n.n(i);e["default"]=a.a},"8f6b":function(t,e,n){"use strict";var i=n("b313"),a=n.n(i);e["default"]=a.a},"979c":function(t,e,n){"use strict";var i=n("68f3"),a=n.n(i);e["default"]=a.a},"9dcf":function(t,e,n){t.exports={tabs:"Tabs_tabs_1QR2X",tab:"Tabs_tab_15Faw",tabSmall:"Tabs_tabSmall_3oxul",tabActive:"Tabs_tabActive_5B2qN",tabApi:"Tabs_tabApi_1DbIs",tabDisabled:"Tabs_tabDisabled_2LyC1",link:"Tabs_link_3QSdo",onlyDesktop:"Tabs_onlyDesktop_2idts",onlyMobile:"Tabs_onlyMobile_33MVU"}},a55e:function(t,e,n){"use strict";var i=n("c432"),a=n.n(i);e["default"]=a.a},aa4e:function(t,e,n){t.exports={stationInfo:"StationInfo_stationInfo_1Dt3D",form:"StationInfo_form_3BKgO",content:"StationInfo_content_3LXMa",situations:"StationInfo_situations_nDEmL"}},add9:function(t,e,n){t.exports={journeyDetails:"JourneyDetails_journeyDetails_3YAJj",display:"JourneyDetails_display_nRo1Q",header:"JourneyDetails_header_2FVDd",heading:"JourneyDetails_heading_1u5lY",closeBtn:"JourneyDetails_closeBtn_2AamI",journeyMeta:"JourneyDetails_journeyMeta_2_eYX",mapLink:"JourneyDetails_mapLink_1boUP",stopList:"JourneyDetails_stopList_2AU0a",stop:"JourneyDetails_stop_1ijip",stopDotCell:"JourneyDetails_stopDotCell_1gJ_N",stopDot:"JourneyDetails_stopDot_-Ig6N",stopPassed:"JourneyDetails_stopPassed_3heFC",stopTime:"JourneyDetails_stopTime_SRZYM",stopName:"JourneyDetails_stopName_1ry27",stopTrack:"JourneyDetails_stopTrack_1BnIw"}},aeaf:function(t,e,n){"use strict";var i=n("aa4e"),a=n.n(i);e["default"]=a.a},b313:function(t,e,n){t.exports={button:"Button_button_Mvymr"}},b679:function(t,e,n){t.exports={tripsFilter:"TripsFilter_tripsFilter_ZISik",filter:"TripsFilter_filter_1W5CS",voice:"TripsFilter_voice_3SGKu",voiceCheckbox:"TripsFilter_voiceCheckbox_2LW6X",refreshBtn:"TripsFilter_refreshBtn_YozBh"}},c11a:function(t,e,n){"use strict";var i=n("00ce"),a=n.n(i);e["default"]=a.a},c21b:function(t,e,n){},c432:function(t,e,n){t.exports={carousel:"MessageCarousel_carousel_2z3mA",playPauseBtn:"MessageCarousel_playPauseBtn_3CJmV",items:"MessageCarousel_items_36jYK",item:"MessageCarousel_item_18VK5",dots:"MessageCarousel_dots_33JNz",dotBtn:"MessageCarousel_dotBtn_hdtJx",dot:"MessageCarousel_dot_3Sbfj",activeDot:"MessageCarousel_activeDot_1Ti6v"}},e713:function(t,e,n){t.exports={offlineIndicator:"OfflineIndicator_offlineIndicator_RWCJm"}}});
//# sourceMappingURL=app-legacy.555a30e6.js.map